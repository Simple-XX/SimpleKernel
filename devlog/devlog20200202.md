# SimpleKernel 开发日志 20200202

- 删除了之前进程相关的代码，重写
- 在之前的提交中更新了代码风格

- 关于任务切换

    首先保存旧任务信息：

    ​	cr3，内核栈，寄存器

    将新任务的相关信息填充进寄存器

    ​	cr3，内核栈，寄存器

    开始执行新任务

    ​	指定 eip

    新任务返回后恢复旧任务的信息到寄存器中

- switch_to

    这个函数一定要用内嵌汇编完成，它实际完成了任务切换的动作

    proc->fork()->switch_to->sub_proc->fork()->proc

    否则的话是无法返回调用它的程序的（指不保存额外变量的情况下）



发现内存分配有 bug，这边先暂停一下，把内存先写完